### Core

코어는 간단하게 말하면 CPU안에서 일하는 부품 중 하나입니다. 보통 프로세스에 4개의 코어가 있는데요. 코어가 하드웨어단에서의 물리적 구성 단위라면, 쓰레드는 소프트웨어 관점에서의 논리적 작업 처리 단위이다.

## process vs Thread

### process

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dbad4a79-f175-47ce-9b75-2424bfc7d224/Untitled.png)

- 프로세스는 각각 독립된 메모리 영역(Code, Data, Stack, Heap의 구조)을 할당받는다.
- 기본적으로 프로세스당 최소 1개의 스레드(메인 스레드)를 가지고 있다.
- PCB(인쇄 회로)라는 곳에 컨텍스트 스위칭 시 저장된다.
- 각 프로세스는 `별도의 주소 공간`에서 실행되며, 한 프로세스는 다른 프로세스의 변수나 자료구조에 `접근할 수 없다.`
- 한 프로세스가 다른 프로세스의 자원에 접근하려면 프로세스 간의 통신(IPC, inter-process communication)을 사용해야 한다. Ex) 파이프, 파일, 소켓 등을 이용한 통신 방법 이용
- JVM은 프로세스가 없고 스레드만 존재한다.

### Thread

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6d712cab-70d9-44e8-877f-1d4efe88f39b/Untitled.png)

- 스레드는 한 프로세스 내에서 동작되는 여러 실행의 흐름으로, 프로세스 내의 주소 공간이나 자원들(힙 공간 등)을 같은 프로세스 내에 스레드끼리 공유하면서 실행된다.
- 각각의 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있다.

스레드는 `레지스트(적어야 하니)와 스택 영역만 공유하지 않는다`.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/feaeccb1-da85-4ec4-92a9-72d90f66e95c/Untitled.png)

## 스택과 힙?

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/17ed927a-7540-4b01-906c-99a1774c64d0/Untitled.png)

### **코드(code) 영역(스레드 공유)**

메모리의 코드(code) 영역은 실행할 프로그램의 코드가 저장되는 영역으로 텍스트(code) 영역이라고도 부릅니다.

CPU는 코드 영역에 저장된 명령어를 하나씩 가져가서 처리하게 됩니다.

### **데이터(data) 영역(스레드 공유)**

메모리의 데이터(data) 영역은 프로그램의 전역 변수와 정적(static) 변수가 저장되는 영역입니다.

데이터 영역은 프로그램의 시작과 함께 할당되며, 프로그램이 종료되면 소멸합니다.

### **힙(heap) 영역(스레드 공유)**

메모리의 힙(heap) 영역은 `사용자가 직접 관리할 수 있는 ‘그리고 해야만 하는’ 메모리 영역`입니다.

힙 영역은 사용자에 의해 메모리 공간이 동적으로 할당되고 해제됩니다.

힙 영역은 메모리의 낮은 주소에서 높은 주소의 방향으로 할당됩니다.

### **스택(stack) 영역 (스레드 공유 X)**

메모리의 스택(stack) 영역은 `함수의 호출과 관계`되는 `지역 변수`와 `매개변수`가 저장되는 영역입니다.

스택 영역은 함수의 호출과 함께 할당되며, `함수의 호출이 완료되면 소멸합니다.`

이렇게 스택 영역에 저장되는 함수의 호출 정보를 스택 프레임(stack frame)이라고 합니다.

스택 영역은 푸시(push) 동작으로 데이터를 저장하고, 팝(pop) 동작으로 데이터를 인출합니다.

이러한 스택은 후입선출(LIFO, Last-In First-Out) 방식에 따라 동작하므로, 가장 늦게 저장된 데이터가 가장 먼저 인출됩니다.

## **스택과 힙의 장단점**

### **스택**

매우 빠른 액세스

변수를 명시 적으로 할당 해제 할 필요가 없습니다.

공간은 CPU에 의해 효율적으로 관리되고 메모리는 단편화되지 않습니다.

지역 변수 만

### **힙(스레드 공유)**

변수는 전역 적으로 액세스 할 수 있습니다.

메모리 크기 제한 없음

(상대적으로) 느린 액세스

효율적인 공간 사용을 보장하지 못하면 메모리 블록이 할당 된 후 시간이 지남에 따라 메모리가 조각화되어 해제 될 수 있습니다.

메모리를 관리해야합니다 (변수를 할당하고 해제하는 책임이 있습니다)

변수는 C언어 realloc() or 자바 new

## 멀티 프로세스 vs 멀티 스레드

### 멀티 프로세스

장점

- 여러 개의 자식 프로세스 중 하나에 문제가 발생하면 그 자식 프로세스만 죽는 것 이상으로 다른 영향이 확산되지 않는다.

단점

- 프로세스는 각각의 독립된 메모리 영역을 할당받았기 때문에 프로세스 사이에서 공유하는 메모리가 없어, Context Switching가 발생하면 캐쉬에 있는 모든 데이터를 모두 리셋하고 다시 캐쉬 정보를 불러와야 한다.

### 멀티스레드

하나의 응용프로그램을 여러 개의 스레드로 구성하고 각 스레드로 하여금 하나의 작업을 처리하도록 하는 것이다.

장점

- 시스템 처리량 증가: 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모가 줄어들게 된다.

프로세스는 각각이 독립된 공간을 갖고 있으므로 프로세스 간의 Context Switching시 단순히 `CPU 레지스터 교체` 뿐만 아니라 RAM과 CPU 사이의 `캐쉬 메모리에 대한 데이터까지 초기화`되므로 오버헤드가 크다.
